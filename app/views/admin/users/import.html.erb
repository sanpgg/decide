<style>
  .input-file {
  position: relative;
  overflow: hidden;
  width: 250px;
  height: 40px;
  border: none;
  background-color: lightgray;
  border-radius: 3px;
  box-shadow: 1px 1px 2px rgba(0,0,0,.5);
  cursor: pointer;
  transition: background-color .3s ease;
  padding: 2px;
}
.input-file:hover {
  background-color: gray;
}
.input-file [type = file] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
}
.input-file label {
  font-family: 'arial';
  color: black;
  font-weight: bold;
  font-size: 17px;
  cursor: pointer;
}

.std {
  font-size: 14px;
}
</style>

<h1>Importar usuarios</h1>

<%= back_link_to %>

<%= link_to 'Nueva importación', import_admin_users_path if @imported_users.present? %>

<hr/>

<%= form_tag({:action => :import_from_csv}, multipart: true, method: :post) do %>
  <div>
    
    <button class="input-file">
      <%= file_field_tag :file, accept: 'text/csv' %>
      <label id="fileLabel" for="file">Importa tu archivo</label>
    </button>

    <%= submit_tag("Agregar", class: "button") %>
  </div>
<% end unless @imported_users.present? %>

<div style="text-align: center;">
  <%= @notice if @notice.present? %>
</div>

<% if @imported_users.present? %>
  <table>
    <thead>
      <th>Usuario</th>
      <th>Correo</th>
      <th>Nombre</th>
      <th>Apellido paterno</th>
      <th>Apellido materno</th>
      <th>CURP</th>
      <th>Teléfono</th>
      <th>Detalles</th>
    </thead>
    <tbody>
      <% @imported_users.each do |user| %>
        <tr>
          <td class="std"><%= user[6] %></td>
          <td class="std"><%= user[0] %></td>
          <td class="std"><%= user[1] %></td>
          <td class="std"><%= user[2] %></td>
          <td class="std"><%= user[3] %></td>
          <td class="std"><%= user[4] %></td>
          <td class="std"><%= user[5] %></td>
          <td class="std"><%= user[7] %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<script>

  var fileInput = document.getElementById('file');

  fileInput.addEventListener("change", function(event) {  
    the_return = document.getElementById('fileLabel');

    the_return.innerText = event.target.files[0].name;
  });

</script>